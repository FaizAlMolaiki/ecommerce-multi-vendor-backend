{% extends 'dashboard/layouts/delete_layout.html' %}

{% block title %}حذف العرض - {{ object.name }} - لوحة التحكم{% endblock %}

{% with page_title='حذف العرض - '|add:object.name %}
{% with item_type='العرض' %}
{% with back_url='/dashboard/pricing/offers/' %}
{% with cancel_url='/dashboard/pricing/offers/' %}

{% block additional_content %}
<div class="row mb-3">
    <div class="col-md-6">
        <h6 class="text-muted">تفاصيل العرض:</h6>
        <div class="mb-3">
            <p class="mb-1"><strong><i class="fas fa-gift me-2"></i>{{ object.name }}</strong></p>
            <p class="mb-1"><strong>النوع:</strong> {{ object.get_offer_type_display }}</p>
            {% if object.required_coupon %}
            <p class="mb-1"><strong>الكوبون المطلوب:</strong> 
                <span class="badge bg-warning">{{ object.required_coupon.code }}</span>
            </p>
            {% endif %}
            <p class="mb-1"><strong>الأولوية:</strong> {{ object.priority }}</p>
            <p class="mb-1"><strong>قابل للتكديس:</strong> 
                {% if object.stackable %}
                    <span class="badge bg-success">نعم</span>
                {% else %}
                    <span class="badge bg-warning">لا</span>
                {% endif %}
            </p>
            <p class="mb-1"><strong>الحالة:</strong> 
                {% if object.active %}
                    <span class="badge bg-success">مفعل</span>
                {% else %}
                    <span class="badge bg-secondary">معطل</span>
                {% endif %}
            </p>
        </div>
    </div>
    <div class="col-md-6">
        <h6 class="text-info">إعدادات العرض:</h6>
        {% if object.configuration %}
        <div class="card">
            <div class="card-body p-2">
                <pre class="small mb-0">{{ object.configuration|pprint }}</pre>
            </div>
        </div>
        {% else %}
        <p class="text-muted">لا توجد إعدادات مخصصة</p>
        {% endif %}
        
        <h6 class="text-warning mt-3">نطاق التطبيق:</h6>
        <ul class="list-unstyled">
            <li><strong>المتاجر:</strong> 
                {% if object.stores.count > 0 %}
                    <span class="badge bg-info">{{ object.stores.count }} متجر</span>
                {% else %}
                    <span class="text-muted">جميع المتاجر</span>
                {% endif %}
            </li>
            <li><strong>الفئات:</strong> 
                {% if object.categories.count > 0 %}
                    <span class="badge bg-info">{{ object.categories.count }} فئة</span>
                {% else %}
                    <span class="text-muted">جميع الفئات</span>
                {% endif %}
            </li>
            <li><strong>المنتجات:</strong> 
                {% if object.products.count > 0 %}
                    <span class="badge bg-info">{{ object.products.count }} منتج</span>
                {% else %}
                    <span class="text-muted">جميع المنتجات</span>
                {% endif %}
            </li>
            <li><strong>المتغيرات:</strong> 
                {% if object.variants.count > 0 %}
                    <span class="badge bg-info">{{ object.variants.count }} متغير</span>
                {% else %}
                    <span class="text-muted">جميع المتغيرات</span>
                {% endif %}
            </li>
        </ul>
        
        {% if object.start_at or object.end_at %}
        <h6 class="text-success mt-3">الفترة الزمنية:</h6>
        <ul class="list-unstyled">
            {% if object.start_at %}
            <li><strong>البداية:</strong> {{ object.start_at|date:"Y-m-d H:i" }}</li>
            {% endif %}
            {% if object.end_at %}
            <li><strong>النهاية:</strong> {{ object.end_at|date:"Y-m-d H:i" }}</li>
            {% endif %}
        </ul>
        {% endif %}
        
        {% if object.min_purchase_amount %}
        <h6 class="text-primary mt-3">شروط إضافية:</h6>
        <ul class="list-unstyled">
            <li><strong>الحد الأدنى للمبلغ:</strong> {{ object.min_purchase_amount }} ر.س</li>
        </ul>
        {% endif %}
    </div>
</div>

<div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle me-2"></i>
    <strong>تحذير:</strong> حذف هذا العرض سيؤثر على جميع الطلبات المستقبلية التي تطبق عليها شروطه.
    {% if object.offer_type == 'BUY_X_GET_Y' %}
        <br>العروض من نوع "اشتر X واحصل على Y" قد تؤثر على حسابات المخزون.
    {% elif object.offer_type == 'BUNDLE_FIXED_PRICE' %}
        <br>عروض الباقات قد تؤثر على أسعار المنتجات المجمعة.
    {% endif %}
</div>
{% endblock %}

{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}

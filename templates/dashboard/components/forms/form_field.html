{% comment %}
مكون حقل النموذج الموحد
الاستخدام: {% include 'dashboard/components/forms/form_field.html' with field=form.name label='الاسم' required=True %}
{% endcomment %}

<div class="mb-3">
    {% if label %}
    <label for="{{ field.id_for_label }}" class="form-label{% if required or field.field.required %} required-field{% endif %}">
        {{ label }}
    </label>
    {% endif %}
    
    {% if field.field.widget.input_type == 'textarea' %}
        <textarea 
            name="{{ field.name }}" 
            id="{{ field.id_for_label }}"
            class="form-control{% if field.errors %} is-invalid{% endif %}"
            {% if field.field.required %}required{% endif %}
            {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
            {% if rows %}rows="{{ rows }}"{% else %}rows="3"{% endif %}
        >{{ field.value|default:'' }}</textarea>
    {% elif field.field.widget.input_type == 'select' %}
        <select 
            name="{{ field.name }}" 
            id="{{ field.id_for_label }}"
            class="form-select{% if field.errors %} is-invalid{% endif %}"
            {% if field.field.required %}required{% endif %}
        >
            {% for choice in field.field.choices %}
                <option value="{{ choice.0 }}" {% if choice.0 == field.value %}selected{% endif %}>
                    {{ choice.1 }}
                </option>
            {% endfor %}
        </select>
    {% elif field.field.widget.input_type == 'checkbox' %}
        <div class="form-check">
            <input 
                type="checkbox" 
                name="{{ field.name }}" 
                id="{{ field.id_for_label }}"
                class="form-check-input{% if field.errors %} is-invalid{% endif %}"
                value="1"
                {% if field.value %}checked{% endif %}
            >
            {% if checkbox_label %}
            <label class="form-check-label" for="{{ field.id_for_label }}">
                {{ checkbox_label }}
            </label>
            {% endif %}
        </div>
    {% else %}
        <input 
            type="{{ field.field.widget.input_type|default:'text' }}" 
            name="{{ field.name }}" 
            id="{{ field.id_for_label }}"
            class="form-control{% if field.errors %} is-invalid{% endif %}"
            value="{{ field.value|default:'' }}"
            {% if field.field.required %}required{% endif %}
            {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
            {% if field.field.widget.input_type == 'number' %}
                {% if min_value %}min="{{ min_value }}"{% endif %}
                {% if max_value %}max="{{ max_value }}"{% endif %}
                {% if step %}step="{{ step }}"{% endif %}
            {% endif %}
        >
    {% endif %}
    
    {% if field.errors %}
        <div class="invalid-feedback">
            {% for error in field.errors %}
                {{ error }}
            {% endfor %}
        </div>
    {% endif %}
    
    {% if help_text %}
        <div class="form-text">{{ help_text }}</div>
    {% endif %}
</div>
